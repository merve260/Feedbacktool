<div class="card" *ngIf="survey; else loading">
  <!-- Titel und Beschreibung der Umfrage -->
  <h2>{{ 'results.detailTitle' | translate }} â€“ {{ survey.title }}</h2>
  <p *ngIf="survey.description">{{ survey.description }}</p>

  <!-- Meta-Daten der Umfrage -->
  <div class="meta">
    <span>
      <strong>{{ 'results.status' | translate }}:</strong>
      {{ ('status.' + survey.status) | translate }}
    </span>
    <span>
      <strong>{{ 'results.start' | translate }}:</strong>
      {{ survey.startAt | date:'dd.MM.yyyy' }}
    </span>
    <span>
      <strong>{{ 'results.end' | translate }}:</strong>
      {{ survey.endAt | date:'dd.MM.yyyy' }}
    </span>
    <span>
      <strong>{{ 'results.answersCount' | translate }}:</strong>
      {{ answers.length }}
    </span>

    <button class="export-btn" (click)="exportToExcel()">
      {{ 'results.export' | translate }}
    </button>
  </div>

  <!-- Charts fÃ¼r jede Frage -->
  <div class="charts-grid">
    <ng-container *ngFor="let q of questions">
      <div class="chart-card">

        <!-- Multiple Choice Diagramm -->
        <app-multiple-chart
          *ngIf="q.type === 'multiple'"
          [surveyId]="survey.id!"
          [question]="q"
          [answers]="answers">
        </app-multiple-chart>

        <!-- Skala (Slider) -->
        <app-skala-chart
          *ngIf="q.type === 'slider'"
          [surveyId]="survey.id!"
          [question]="q"
          [answers]="answers">
        </app-skala-chart>

        <!-- Radio Button Diagramm -->
        <app-radio-button-chart
          *ngIf="q.type === 'radio'"
          [surveyId]="survey.id!"
          [question]="q"
          [answers]="answers">
        </app-radio-button-chart>

        <!-- Sterne-Bewertung -->
        <app-star-rating-chart
          *ngIf="q.type === 'star'"
          [surveyId]="survey.id!"
          [question]="q"
          [answers]="answers">
        </app-star-rating-chart>

        <!-- Freitext Antworten -->
        <app-freitext-list
          *ngIf="q.type === 'freitext'"
          [surveyId]="survey.id!"
          [question]="q"
          [answers]="freitextAnswersMap[q.id] || []"
          (click)="openChartDialog(q)">
        </app-freitext-list>
      </div>
    </ng-container>
  </div>
</div>

<!-- Ladezustand -->
<ng-template #loading>
  <div class="card">
    <p>{{ 'results.loading' | translate }}</p>
  </div>
</ng-template>
